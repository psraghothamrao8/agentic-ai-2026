<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agentic AutoML | Dashboard</title>
    <!-- Modern font from Google -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="app.js" defer></script>
    <script>
        window.addEventListener('error', function (e) {
            if (e.target.tagName === 'SCRIPT') {
                console.error('Failed to load script:', e.target.src);
            }
        }, true);
    </script>
</head>

<body>

    <div class="container">
        <header>
            <div class="logo">
                Agentic AutoML
            </div>
            <div id="status-container" style="display: flex; gap: 15px; align-items: center;">
                <div class="dropdown">
                    <button class="dropbtn">
                        â†» System Reset â–¼
                    </button>
                    <div class="dropdown-content">
                        <a href="#" onclick="performSoftReset()">Soft Reset (State Only)</a>
                        <a href="#" onclick="performHardReset()" class="danger-action">Hard Reset (Delete All)</a>
                    </div>
                </div>
                <div class="status-badge" id="system-status">System Standby</div>
            </div>
        </header>

        <main>
            <!-- Dataset Management -->
            <section class="agent-card card-magic">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2>Dataset Management</h2>
                        <p style="color: var(--text-secondary); margin-top: 4px;">Upload your dataset zip file to start
                        </p>
                    </div>
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <input type="file" id="dataset-upload" accept=".zip"
                            style="font-size: 0.8rem; background: rgba(0,0,0,0.2); padding: 8px; border-radius: 8px; border: 1px solid var(--card-border);">
                        <button class="btn-magic" onclick="uploadAndRun()" id="upload-btn" style="min-width: 180px;">
                            ðŸš€ Upload & Run
                        </button>
                    </div>
                </div>
                <div id="upload-status"></div>
            </section>

            <!-- AI Agent Analysis Section -->
            <section class="agent-card">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <h2>Intelligent Agent Analysis</h2>
                        <p style="color: var(--text-secondary); margin-top: 8px;">Llama3 analyzing your dataset health
                            and quality</p>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" onclick="triggerAnalysis()" id="analyze-btn">
                            Run Analysis
                        </button>
                        <button class="btn-primary" onclick="evaluateCurrentModel()" id="evaluate-btn"
                            style="background: var(--success-color);">
                            ðŸ“Š Evaluate Current Model
                        </button>
                    </div>
                </div>
                <div id="agent-output" class="agent-response">
                    Dashbord initiated. Waiting for dataset analysis...
                </div>
            </section>

            <!-- Data Cleaning & Issue Management Section -->
            <section id="cleaning-section" style="display: none;">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; background: rgba(0,0,0,0.2); padding: 16px; border-radius: 16px;">
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <h3>Dataset Issues</h3>
                        <div id="issue-count-pill"
                            style="background: var(--danger-color); color: white; padding: 2px 10px; border-radius: 10px; font-size: 0.8rem; font-weight: 700;">
                            0</div>

                        <button class="btn-primary" onclick="downloadCSV()"
                            style="font-size: 0.75rem; padding: 4px 10px; height: auto; min-height: unset; background: var(--card-bg); border: 1px solid var(--accent-color); color: var(--accent-color);">
                            â¬‡ CSV
                        </button>
                    </div>

                    <div style="display: flex; gap: 12px; align-items: center;">
                        <button class="btn-magic" onclick="autoFixAll()" id="auto-fix-all-btn">Auto-Fix All
                            Suggestions</button>
                        <div style="width: 1px; height: 30px; background: var(--card-border);"></div>

                        <span style="font-size: 0.85rem; color: var(--text-secondary);">Batch Action:</span>
                        <select id="batch-label-select">
                            <option value="">Move to...</option>
                        </select>
                        <button class="btn-success" onclick="applyBatchFix()" id="batch-apply-btn"
                            style="min-width: 120px;">Apply to Selected</button>

                        <div style="width: 1px; height: 30px; background: var(--card-border); margin: 0 10px;"></div>

                        <button class="btn-primary" onclick="skipToBenchmark()"
                            style="background: var(--accent-color); color: white;">Proceed to Benchmark &rarr;</button>
                    </div>
                </div>

                <div style="margin-bottom: 12px; display: flex; align-items: center; gap: 8px; padding-left: 10px;">
                    <input type="checkbox" id="select-all-issues" onchange="toggleSelectAll()" class="issue-checkbox">
                    <label for="select-all-issues" style="font-size: 0.9rem; font-weight: 600; cursor: pointer;">Select
                        All</label>
                </div>

                <div class="issues-grid" id="issues-container">
                    <!-- Data cards dynamically loaded here -->
                </div>
            </section>

            <!-- AutoML Benchmarking Section -->
            <section id="training-section" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <h2>AutoML Benchmarking</h2>
                        <p style="color: var(--text-secondary); margin-top: 4px;">Evaluating ResNet, MobileNet, and
                            EfficientNet architectures</p>
                    </div>
                    <button class="btn-primary" onclick="startTraining()" id="train-btn">
                        Start Multi-Model Benchmark
                    </button>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 300px; gap: 20px;">
                    <div id="training-logs" class="agent-response training-logs-container">
                        Optimization history will appear here...
                    </div>
                    <div id="benchmark-results"
                        style="background: rgba(0,0,0,0.2); border-radius: 16px; padding: 15px;">
                        <h4 style="margin-bottom: 15px; font-size: 0.9rem; color: var(--accent-color);">Leaderboard</h4>
                        <div id="leaderboard-content" style="font-size: 0.85rem;">
                            No models trained yet.
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <aside>
            <div class="stats-card">
                <h3
                    style="margin-bottom: 20px; font-size: 1.1rem; border-bottom: 1px solid var(--card-border); padding-bottom: 10px;">
                    Dataset Overview</h3>
                <div id="stats-container">
                    <p style="color: var(--text-secondary);">Analyzing metadata...</p>
                </div>
            </div>

            <div
                style="margin-top: auto; padding: 20px; text-align: center; background: rgba(139, 92, 246, 0.05); border-radius: 20px; border: 1px dashed rgba(139, 92, 246, 0.2);">
                <p style="font-size: 0.8rem; color: var(--text-secondary); margin: 0;">Built with <b>Llama3</b>,
                    <b>Cleanlab</b> & <b>PyTorch</b>
                </p>
            </div>
        </aside>
    </div>
</body>

</html>